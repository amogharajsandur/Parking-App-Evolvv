@import '../../styles/variables';
@import '../../styles/mixins';

.valetPage {
  @include container-base;

  @include desktop {
    max-width: 480px;
    margin: 0 auto;
    border-left: 1px solid #e2e8f0;
    border-right: 1px solid #e2e8f0;
    height: 100vh;
  }

  .loadingOverlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(4px);
    z-index: 200;
    @include flex;
    animation: fadeIn 0.2s ease-out;

    .loadingCard {
      background: white;
      padding: 32px 24px;
      border-radius: 24px;
      width: 80%;
      text-align: center;
      @include flex(center, center, column, 12px);
      box-shadow: $shadow-premium-hover;
      animation: zoomIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);

      .iconCircle {
        width: 64px;
        height: 64px;
        background: #eef2ff;
        border-radius: 50%;
        @include flex;
        @include role-theme('color', 'primary');
        margin-bottom: 8px;
      }

      h3 { font-size: 16px; font-weight: 700; color: #1e293b; }
      .carName { font-size: 14px; font-weight: 600; color: #475569; margin-bottom: 2px; }
      .plate { font-size: 12px; color: #94a3b8; font-family: 'JetBrains Mono', monospace; margin-bottom: 16px; }

      .progressBar {
        width: 100%;
        height: 6px;
        background: $bg-light;
        border-radius: 4px;
        overflow: hidden;
        margin-top: 8px;

        .progressFill {
          height: 100%;
          height: 100%;
          @include role-theme('background', 'primary');
          width: 0%;
          border-radius: 4px;
          animation: progressFill 2s linear forwards;
        }
      }
    }
  }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; }}
  @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; }}
  @keyframes progressFill { 0% { width: 0%; } 100% { width: 100%; }}

  .valetHeader {
    @include glass-header;
    // background handled by mixin inside glass-header
    
    .top {
      @include flex(space-between, center);

      .user {
        @include flex(flex-start, center, row, $spacing-md);

        .backBtn {
          @include back-button;
          background: rgba(255, 255, 255, 0.2);
        }

        .userDetails {
          p { font-size: 11px; text-transform: uppercase; color: rgba(255, 255, 255, 0.8); letter-spacing: 0.5px; }
          .welcome { 
            h3 { font-size: 18px; font-weight: 700; color: white; margin-top: 2px; } 
          }
        }
      }

      .notificationBell {
        position: relative;
        width: 44px;
        height: 44px;
        background: rgba(255, 255, 255, 0.2); // Matching slightly opaque look
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: $radius-md;
        @include flex;
        color: white;

        .count {
          position: absolute;
          top: -4px;
          right: -4px;
          background: #ef4444; 
          color: white;
          font-size: 10px;
          width: 18px;
          height: 18px;
          border-radius: 50%;
          border-radius: 50%;
          @include flex;
          border: 2px solid;
          @include role-theme('border-color', 'primary');
          font-weight: 800;
        }
      }
    }
  }

  .contentScroll {
    @include content-scroll;
  }

  // Stats for Driver
  .driverStats {
    @include flex(space-between, center);
    margin-bottom: $spacing-xl;
    gap: $spacing-md;

    .statBox {
        @include premium-card;
        flex: 1;
        text-align: center;
        padding: 12px;
        background: white;
        
        label { 
            display: block; 
            font-size: 10px; 
            text-transform: uppercase; 
            color: $text-muted; 
            font-weight: 700; 
            margin-bottom: 4px;
        }
        h4 {
            font-size: 16px;
            font-weight: 800;
            color: #1e293b;
        }
    }
  }

  .newAssignments {
    margin-bottom: $spacing-xl;
    margin-top: -$spacing-md;
    
    .labelRow {
      @include flex(flex-start, center, row, 10px);
      margin-bottom: $spacing-md;
      padding-left: 4px;
      
      .bellIcon { 
        @include role-theme('color', 'primary');
      }

      h3 { font-size: 15px; font-weight: 700; color: #334155; }
    }

    .newTaskCard {
      background: white;
      border: 2px dashed #fbbf24; // Use Amber for valet tasks
      padding: $spacing-lg;
      border-radius: $radius-xl;
      box-shadow: $shadow-sm;

      .taskTop {
        @include flex(flex-start, center, row, 14px);
        margin-bottom: $spacing-md;
        position: relative;
        
        .carIcon {
          width: 48px;
          height: 48px;
          background: #fef3c7;
          border-radius: 14px;
          @include flex;
          color: #d97706;
        }
        .carInfo {
          h4 { font-size: 16px; font-weight: 700; color: #1e293b; margin-bottom: 2px; }
          p { font-size: 12px; color: $text-muted; font-family: 'JetBrains Mono', monospace; font-weight: 600; }
        }
        .timeBadge {
          margin-left: auto;
          background: #fee2e2;
          color: #ef4444;
          font-size: 11px;
          padding: 4px 8px;
          border-radius: 6px;
          font-weight: 700;
        }
      }

      .retrieveBadge {
        background: #fef9c3;
        color: #a16207;
        padding: 5px 14px;
        border-radius: 10px;
        font-size: 11px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-block;
        margin-bottom: $spacing-lg;
        
        &.park {
            background: #dcfce7;
            color: #15803d;
        }
      }

      .acceptBtn {
        width: 100%;
        background: #1e293b;
        color: white;
        border: none;
        padding: 14px;
        border-radius: 14px;
        font-weight: 700;
        font-size: 14px;
        cursor: pointer;
        @include flex(center, center, row, 8px);
        transition: $transition-base;
        
        &:hover { transform: translateY(-2px); box-shadow: $shadow-md; }
      }
    }
  }

  .currentAssignment {
    margin-bottom: $spacing-xl;
    
    .sectionTitle {
      h3 { font-size: 15px; font-weight: 700; margin-bottom: $spacing-md; color: #334155; padding-left: 4px; }
    }

    .emptyState {
        text-align: center;
        padding: 40px 20px;
        color: $text-muted;
        background: white;
        border-radius: $radius-xl;
        font-style: italic;
    }

    .assignmentCard {
      @include premium-card;
      background: white;
      padding: 24px;
      border-radius: 20px;
      box-shadow: $shadow-md;

      .cardHeader {
        @include flex(flex-start, center, row, 16px);
        margin-bottom: 24px;
        
        .carIconLarge {
          width: 56px;
          height: 56px;
          background: #dcfce7; // Light green bg
          border-radius: 16px;
          @include flex;
          color: #16a34a; // Green icon
        }

        .title {
          flex: 1;
          h2 { font-size: 20px; font-weight: 800; color: #1e293b; margin-bottom: 4px; }
          p { font-size: 14px; color: #64748b; font-family: 'JetBrains Mono', monospace; font-weight: 600; letter-spacing: 0.5px; }
        }

        .statusBadge {
          background: #dcfce7;
          color: #16a34a;
          padding: 6px 14px;
          border-radius: 8px;
          font-size: 11px;
          font-weight: 800;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
      }

      .infoList {
        @include flex(flex-start, stretch, column, 16px);
        margin-bottom: 24px;
        background: transparent;
        padding: 0;

        .infoItem {
          @include flex(flex-start, center, row, 16px);
          padding: 4px 0;
          
          .icon {
            width: 44px;
            height: 44px;
            background: #f8fafc;
            border-radius: 12px;
            @include flex;
            color: #64748b;
            border: none;
          }

          .text {
            label { font-size: 10px; text-transform: uppercase; color: #94a3b8; display: block; margin-bottom: 2px; font-weight: 700; letter-spacing: 0.5px; }
            p { font-size: 15px; font-weight: 700; color: #334155; }
            span { font-size: 12px; color: #94a3b8; font-weight: 500; }
            .highlight { color: #16a34a; font-weight: 700; font-size: 15px; }
          }
        }
      }

      .completeBtn {
        width: 100%;
        background: #1e293b;
        color: white;
        border: none;
        padding: 18px;
        border-radius: 16px;
        font-weight: 700;
        font-size: 15px;
        cursor: pointer;
        transition: $transition-base;
        box-shadow: 0 4px 12px -2px rgba(30, 41, 59, 0.2);
        
        &:hover { transform: translateY(-2px); box-shadow: 0 8px 16px -4px rgba(30, 41, 59, 0.3); }
        &:active { transform: scale(0.98); }
      }
    }
  }

  .completedSection {
    .sectionTitle {
        h3 { font-size: 15px; font-weight: 700; margin-bottom: $spacing-md; color: #334155; padding-left: 4px; }
    }
    .completedList {
        .completedItem {
            background: white;
            padding: 12px 16px;
            border-radius: 12px;
            @include flex(flex-start, center, row, 12px);
            font-size: 13px;
            color: $text-muted;
            margin-bottom: 8px;

            .tick { color: $success; }
            b { color: $text-main; }
            .time { margin-left: auto; font-size: 11px; font-weight: 600; }
        }
    }
  }
}